<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Quiz Adventure</title>
<style>
 body{font-family:system-ui;padding:14px;background:linear-gradient(#fff,#f8fbff)}
 .card{background:#fff;padding:12px;border-radius:10px;box-shadow:0 10px 28px rgba(0,0,0,.06)}
 .layout{display:grid;grid-template-columns:360px 1fr;gap:12px}
 button{padding:8px;border-radius:6px}
</style>
</head><body>
<h1>ðŸ—º Quiz Adventure</h1>
<div class="layout">
  <aside class="card">
    <h3>Hero</h3>
    <div>Name: <input id="name" value="Ethan"/></div>
    <div>Inventory: <span id="inv">None</span></div>
    <hr/>
    <button id="save">Save</button><button id="export">Export</button><input id="importFile" type="file" accept="application/json" style="display:none"/><button id="importBtn">Import</button>
  </aside>

  <main class="card">
    <div id="roomTitle"></div>
    <div id="roomText" style="margin-top:8px"></div>
    <div id="choices" style="margin-top:12px"></div>
    <div style="margin-top:12px" id="log" class="small"></div>
  </main>
</div>

<script>
const Game = {key:'lore_v1', init(){ if(!localStorage.getItem(this.key)) this.save(); else this.load(); }, save(){ localStorage.setItem(this.key, JSON.stringify(this.state)); log('Saved'); }, load(){ const s=localStorage.getItem(this.key); if(s) this.state = JSON.parse(s); }, export(){ const raw=localStorage.getItem(this.key); if(!raw) return alert('No save'); const blob=new Blob([raw],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='lore_save.json'; a.click(); URL.revokeObjectURL(url); }, import(file,cb){ const r=new FileReader(); r.onload=e=>{ try{ localStorage.setItem(this.key,e.target.result); this.load(); if(cb)cb(true);}catch(e){ if(cb)cb(false);} }; r.readAsText(file); } };
Game.state = {name:'Ethan',room:'start',inv:[],log:[]};
Game.init();
const rooms = {
  start:{title:'The Road',text:'You stand at a fork. A sign points to "Forest" and "Village".',choices:[{t:'Go to Forest',to:'forest'},{t:'Go to Village',to:'village'}]},
  forest:{title:'Ancient Forest',text:'A riddle-keeper blocks the path. Solve a riddle to pass.',puzzle:{q:'I speak without a mouth and hear without ears. What am I?',a:'echo'},choices:[{t:'Answer riddle',action:'riddle'},{t:'Return',to:'start'}]},
  village:{title:'Quiet Village',text:'Villagers trade goods. A merchant offers you a torch if you bring 10 wood.',choices:[{t:'Talk to Merchant',to:'merchant'},{t:'Return',to:'start'}]},
  merchant:{title:'Merchant',text:'Merchant: bring me 10 wood and get a torch.',choices:[{t:'Buy torch (10g)',action:'buyTorch'},{t:'Return',to:'village'}]}
};
function renderRoom(){
  const r = rooms[Game.state.room];
  $('roomTitle').textContent = r.title;
  $('roomText').textContent = r.text;
  const c = $('choices'); c.innerHTML = '';
  (r.choices||[]).forEach(ch=>{
    const b = document.createElement('button'); b.textContent = ch.t;
    b.onclick = ()=> {
      if(ch.to) { Game.state.room = ch.to; log('Moved to '+ch.to); renderRoom(); Game.save(); }
      if(ch.action) handleAction(ch.action);
    };
    c.appendChild(b);
  });
}
function handleAction(act){
  if(act==='riddle'){
    const ans = prompt(rooms['forest'].puzzle.q);
    if(ans && ans.trim().toLowerCase() === rooms['forest'].puzzle.a){ alert('Correct! You receive a map.'); Game.state.inv.push('map'); log('Solved riddle'); Game.save(); renderInv(); }
    else alert('Wrong.');
  } else if(act==='buyTorch'){
    // simple economy omitted due to time
    alert('You trade for a torch.');
    Game.state.inv.push('torch'); Game.save(); renderInv();
  }
}
function renderInv(){ $('inv').textContent = Game.state.inv.length? Game.state.inv.join(', ') : 'None'; }
function log(msg){ Game.state.log.unshift(new Date().toLocaleTimeString() + ' â€” ' + msg); $('log').innerHTML = Game.state.log.slice(0,20).join('<br/>'); }
document.getElementById('save').onclick = ()=>{ Game.save(); alert('Saved'); };
document.getElementById('export').onclick = ()=>Game.export();
document.getElementById('importBtn').onclick = ()=>$('importFile').click();
$('importFile').onchange = (e)=>{ const f=e.target.files[0]; if(!f) return; Game.import(f, ok=>{ if(ok) renderRoom(); else alert('Import failed'); }); };
renderRoom(); renderInv(); log('Begin your quest!');
</script>
</body>
</html>
